<!-- 「LINEで相談する」は shop.line_url 直リンクをやめて、shop_consult に行く。 -->
{% extends "base.html" %}
{% block title %}{{ shop.name }}{% endblock %}

{% block content %}
<h1>{{ shop.name }}</h1>

{% if shop.description %}
  <p>{{ shop.description }}</p>
{% endif %}

<p>{{ shop.street.name }} のお店</p>

{# ✅ LINEで相談する：まずは相談文生成ページへ（preset引き継ぎ） #}
<a class="btn btn-success"
href="{{ consult_url }}">LINEで相談する
</a>

<h2 class="h5 mt-4">商品</h2>

<div class="list-group">
  {% for product in products %}
    <div class="list-group-item d-flex justify-content-between align-items-center">
      <div>
        <div class="fw-bold">{{ product.name }}</div>
        <div class="text-muted small">{{ product.price }}円</div>
      </div>

      <div class="d-flex gap-2">
        <a class="btn btn-outline-secondary btn-sm"
           href="{% url 'dicon_app:product_detail' product.id %}">
          詳細
        </a>
        <a class="btn btn-sm btn-dark" href="{% url 'payments:checkout' product.id %}">購入</a>
      </div>
    </div>
  {% empty %}
    <div class="list-group-item">このお店にはまだ商品がありません</div>
  {% endfor %}
</div>

<p>
  <a href="{% url 'dicon_app:shop_list_by_street' street_slug=shop.street.slug %}{% if preset %}?preset={{ preset }}{% endif %}">
    店舗一覧へ戻る
  </a>
</p>
{% endblock %}
