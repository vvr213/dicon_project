{% extends "base.html" %}
{% load static %}
{% block title %}ãƒãƒ£ãƒƒãƒˆç›¸è«‡{% endblock %}

{% block content %}
<div class="container py-4" style="max-width: 600px;">
  
  <div class="d-flex align-items-center mb-4 p-3 bg-white rounded-4 shadow-sm">
    <div class="position-relative">
      <img src="https://images.unsplash.com/photo-1583336137348-c1f62152a268?auto=format&fit=crop&w=200&q=80" class="rounded-circle" width="60" height="60" style="object-fit: cover;">
      <span class="position-absolute bottom-0 end-0 bg-success border border-white rounded-circle p-2"></span>
    </div>
    <div class="ms-3">
      <h5 class="fw-bold m-0">ç²¾è‚‰ã®ã‚¿ãƒŠã‚«ï¼ˆåº—ä¸»ï¼‰</h5>
      <small class="text-success"><i class="fa-solid fa-circle me-1"></i>ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ»å³ç­”ã—ã¾ã™ï¼</small>
    </div>
  </div>

  <div id="chat-area" class="bg-light p-4 rounded-4 mb-4 overflow-auto" style="height: 400px; border: 2px solid #eee;">
    
    <div class="d-flex mb-3">
      <img src="https://images.unsplash.com/photo-1583336137348-c1f62152a268?auto=format&fit=crop&w=200&q=80" class="rounded-circle me-2 align-self-end" width="40" height="40" style="object-fit: cover;">
      <div class="bg-white p-3 rounded-4 shadow-sm" style="border-bottom-left-radius: 0;">
        <p class="mb-0">ã„ã‚‰ã£ã—ã‚ƒã„ï¼ä»Šæ—¥ã¯ä½•ã«ã™ã‚‹ï¼Ÿ<br>äºˆç®—ã¨ã‹äººæ•°è¨€ã†ã¦ãã‚ŒãŸã‚‰ã€è¦‹ç¹•ã†ã§ã€œğŸ¥©</p>
      </div>
    </div>

  </div>

  <div class="bg-white p-3 rounded-4 shadow-sm border">
    <p class="small text-muted mb-2"><i class="fa-solid fa-wand-magic-sparkles me-1 text-warning"></i>ãƒ‡ãƒ¢ç”¨ï¼šé€ä¿¡å†…å®¹ã‚’é¸ã‚“ã§ãã ã•ã„</p>
    <button onclick="sendDemoMessage()" class="btn btn-danger w-100 rounded-pill fw-bold py-2">
      <i class="fa-solid fa-paper-plane me-2"></i>ã€Œä»Šå¤œ4äººã§ç„¼è‚‰ï¼äºˆç®—5000å††ã§ãŠé¡˜ã„ï¼ã€ã¨é€ã‚‹
    </button>
  </div>

</div>

<script>
  function sendDemoMessage() {
    const chatArea = document.getElementById('chat-area');
    
    // 1. è‡ªåˆ†ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
    const myMsg = `
      <div class="d-flex justify-content-end mb-3 animate-fade-in">
        <div class="bg-danger text-white p-3 rounded-4 shadow-sm" style="border-bottom-right-radius: 0; max-width: 80%;">
          <p class="mb-0">ä»Šå¤œã€å®¶æ—4äººã§ç„¼è‚‰ã—ãŸã„ã‚“ã‚„ã‘ã©â€¦<br>äºˆç®—5,000å††ãã‚‰ã„ã§ã€ã„ã„æ„Ÿã˜ã«è¦‹ç¹•ã£ã¦ãã‚Œã¸ã‚“ï¼ŸğŸ™</p>
        </div>
      </div>
    `;
    chatArea.insertAdjacentHTML('beforeend', myMsg);
    chatArea.scrollTop = chatArea.scrollHeight;

    // 2. ã€Œæ—¢èª­ã€æ¼”å‡ºï¼ˆå°‘ã—å¾…ã¤ï¼‰
    setTimeout(() => {
      // 3. åº—ä¸»ã‹ã‚‰ã®è¿”ä¿¡ï¼ˆã‚¿ã‚¤ãƒ”ãƒ³ã‚°ä¸­...ï¼‰
      const typingMsg = `
        <div id="typing" class="d-flex mb-3">
          <img src="https://images.unsplash.com/photo-1583336137348-c1f62152a268?auto=format&fit=crop&w=200&q=80" class="rounded-circle me-2 align-self-end" width="40" height="40">
          <div class="bg-white p-3 rounded-4 shadow-sm">
            <i class="fa-solid fa-ellipsis fa-fade"></i>
          </div>
        </div>
      `;
      chatArea.insertAdjacentHTML('beforeend', typingMsg);
      chatArea.scrollTop = chatArea.scrollHeight;

      // 4. æœ¬å½“ã®è¿”ä¿¡ã‚’è¡¨ç¤º
      setTimeout(() => {
        document.getElementById('typing').remove(); // ã‚¿ã‚¤ãƒ”ãƒ³ã‚°æ¶ˆã™
        
        const shopMsg = `
          <div class="d-flex mb-3 animate-fade-in">
            <img src="https://images.unsplash.com/photo-1583336137348-c1f62152a268?auto=format&fit=crop&w=200&q=80" class="rounded-circle me-2 align-self-end" width="40" height="40">
            <div class="bg-white p-3 rounded-4 shadow-sm" style="border-bottom-left-radius: 0;">
              <p class="mb-2">ã¾ã„ã©ï¼å®¶æ—ã§ç„¼è‚‰ãˆãˆãªãğŸ˜‹<br>ã»ãªã€ä»Šæ—¥ã¯ãˆãˆã‚«ãƒ«ãƒ“å…¥ã£ã¦ã‚‹ã‹ã‚‰ã€ãƒ­ãƒ¼ã‚¹ã¨åˆã‚ã›ãŸ<strong>ã€Œæº€è…¹ã‚»ãƒƒãƒˆã€</strong>ç‰¹åˆ¥ã«ä½œã£ãŸã‚‹ã‚ï¼</p>
              
              <div class="card border-0 bg-light rounded-3 overflow-hidden">
                <div class="d-flex">
                  <img src="https://images.unsplash.com/photo-1607623814075-e51df1bdc82f?auto=format&fit=crop&w=200&q=80" width="80" style="object-fit: cover;">
                  <div class="p-2">
                    <div class="fw-bold small">ã€ç‰¹åˆ¥ã€‘åº—é•·ã®ç„¼è‚‰ãŠã¾ã‹ã›ã‚»ãƒƒãƒˆ(4äººå‰)</div>
                    <div class="text-danger fw-bold">Â¥5,000</div>
                  </div>
                </div>
                <a href="{% url 'dicon_app:add_to_cart' 999 %}" class="btn btn-sm btn-danger m-2 rounded-pill fw-bold">
                  <i class="fa-solid fa-cart-plus me-1"></i>ã‚«ãƒ¼ãƒˆã«å…¥ã‚Œã‚‹
                </a>
              </div>
            </div>
          </div>
        `;
        chatArea.insertAdjacentHTML('beforeend', shopMsg);
        chatArea.scrollTop = chatArea.scrollHeight;
        
      }, 2500); // 2.5ç§’å¾Œã«è¿”ä¿¡

    }, 500);
  }
</script>

<style>
  .animate-fade-in { animation: fadeIn 0.5s ease-out; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
</style>
{% endblock %}