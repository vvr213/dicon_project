{% extends "base.html" %}
{% load static %}

{% block title %}ホーム{% endblock %}

{% block content %}

<style>
  /* 全体の背景色（広島レッド）とドット柄 */
  body {
    background-color: #b71c1c !important;
    background-image: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
    background-size: 20px 20px;
    color: white;
  }
  
  /* セクションごとの背景（白ベース） */
  .section-card {
    background-color: #f8f9fa;
    color: #333;
    border-radius: 1.5rem;
    overflow: hidden;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    margin-bottom: 3rem;
  }

  /* ヒーロー画像のカルーセル矢印を見やすく */
  .carousel-control-prev-icon,
  .carousel-control-next-icon {
    filter: drop-shadow(0px 0px 3px rgba(0,0,0,0.5));
  }
  
  /* アニメーション */
  .animate-pulse { animation: pulse 2s infinite; }
  @keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
  }
  .hover-scale { transition: transform 0.2s; }
  .hover-scale:hover { transform: scale(1.03); }
</style>

<section class="position-relative w-100 overflow-hidden d-flex align-items-center justify-content-center mb-5" 
         style="min-height: 600px; background-color: #333;">
  
         {% if slides and slides.0.image %}
         <div class="position-absolute top-0 start-0 w-100 h-100" 
              style="background-image: url('{{ slides.0.image.url }}'); background-size: cover; background-position: center; z-index: 0;">
         </div>
       {% else %}
         <div class="position-absolute top-0 start-0 w-100 h-100" 
              style="background-image: url('{% static 'img/shopping_street_bg.jpg' %}'); background-size: cover; background-position: center; z-index: 0;">
         </div>
       {% endif %}
     
       <div class="position-absolute top-0 start-0 w-100 h-100 bg-dark" style="opacity: 0.3; z-index: 1;"></div>

  <div class="container position-relative text-center z-2 px-3 py-5"><div class="mb-4">
    <!-- <p class="text-white fw-bold ls-2 mb-3 d-inline-block border-bottom border-danger border-3" style="font-size: clamp(0.9rem, 2vw, 1.2rem);">
        <i class="fa-solid fa-bell-concierge me-2 text-danger"></i>商店街で<br>あったらいいな！の買い物アプリやねん<br>いっぺん使ってみて〜
    </p> -->

    <div class="d-flex justify-content-center align-items-end mb-3">
      <img src="{% static 'img/hero_smartphone.png' %}" 
           alt="スマホで注文" 
           style="width: 150px; max-width: 30vw; height: auto; filter: drop-shadow(0 5px 15px rgba(0,0,0,0.6)); transform: rotate(-8deg) translateX(5px); z-index: 2;">
      
      <img src="{% static 'img/hero_locker.png' %}" 
           alt="ロッカーで受取" 
           style="width: 180px; max-width: 35vw; height: auto; filter: drop-shadow(0 5px 15px rgba(0,0,0,0.6)); transform: translateX(-5px); z-index: 1;">
  </div>

    <h1 class="text-white fw-bold mb-4" style="font-family: 'Mochiy Pop One', sans-serif; text-shadow: 0 4px 15px rgba(0,0,0,0.9); font-size: clamp(1.5rem, 4.5vw, 3.5rem); line-height: 1.3;">
      アプリで
      <span class="d-inline-block text-warning mx-1" 
            style="font-size: 1.2em; text-shadow: none;">注文</span>、<br class="d-md-none">
      
      ロッカーで
      <span class="d-inline-block mx-1" 
            style="color: #ff3547; font-size: 1.2em; text-shadow: none;">受取</span>
    </h1>
    
    <h2 class="text-white fw-bold mb-4" style="font-family: 'Mochiy Pop One', sans-serif; text-shadow: 0 4px 15px rgba(0,0,0,0.8); font-size: clamp(1.5rem, 4vw, 3.5rem); line-height: 1.4;">
        商店街は18時までやけど、<br>
        ロッカーは<span class="text-danger bg-white px-3 rounded-3" style="font-size: 0.9em; text-shadow: none; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">24時間</span>やってます。
    </h2>
    
    <p class="text-white fw-bold opacity-95 mx-auto" style="font-size: clamp(1rem, 2.5vw, 1.3rem); text-shadow: 0 2px 8px rgba(0,0,0,0.9); line-height: 1.9; max-width: 800px;">
        <span class="text-warning">「ハンバーグのタネだけ、どっさりほしい」</span><br>
        <span class="text-warning">「ごぼうのあく抜きささがき、一掴みほしい」</span><br>
        <!-- <span class="text-warning">「子ども用にカレイの煮付け薄味で１尾と、大人用の味付け２尾」</span><br> -->
        ニッチな注文も、チャットで店に相談してや!<br>
        駅前の商店街で、「あなた専用」の注文とタイミングで受け取ってな。
    </p>
</div>
  
    <div class="mt-5 d-flex flex-column flex-sm-row justify-content-center gap-3">
      <a href="{% url 'dicon_app:shop_list' %}" class="btn btn-danger btn-lg rounded-pill px-5 py-3 shadow fw-bold hover-scale border-2 border-white" style="font-size: 1.2rem;">
        <i class="fa-solid fa-store me-2"></i>お店をのぞく
      </a>
      <a href="{% url 'dicon_app:consult_home' %}" class="btn btn-outline-light btn-lg rounded-pill px-5 py-3 shadow fw-bold hover-scale" style="font-size: 1.2rem; border-width: 2px;">
        <i class="fa-regular fa-comments me-2"></i>チャットで相談
      </a>
    </div>
  
  </div>
</section>

<section class="container mb-5" style="margin-top: -3rem; position: relative; z-index: 10;">
  <div class="row g-3 justify-content-center">
    
    <div class="col-md-4">
      <div class="card h-100 border-0 shadow text-center py-4 px-3 rounded-4" style="background: rgba(255, 255, 255, 0.98);">
        <div class="position-absolute top-0 start-50 translate-middle">
          <span class="badge rounded-pill bg-danger border border-4 border-white shadow-sm px-3 py-2" style="font-size: 1rem;">STEP 1</span>
        </div>
        <div class="mt-4 mb-2 text-danger">
          <i class="fa-solid fa-mobile-screen-button fa-3x"></i>
        </div>
        
        <div class="text-secondary fw-bold small ls-1 mb-1">ORDER & CHAT</div>
        <h5 class="fw-bold mb-3">スマホで注文・相談</h5>
        
        <p class="text-muted small mb-0 lh-sm">
          通勤時間や隙間時間にポチッ。<br>
          「子供が食べるから薄味で」<br>
          そんなニーズもチャットや電話でOK。
        </p>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card h-100 border-0 shadow text-center py-4 px-3 rounded-4" style="background: rgba(255, 255, 255, 0.98);">
        <div class="position-absolute top-0 start-50 translate-middle">
          <span class="badge rounded-pill bg-danger border border-4 border-white shadow-sm px-3 py-2" style="font-size: 1rem;">STEP 2</span>
        </div>
        <div class="mt-4 mb-2 text-danger">
          <i class="fa-solid fa-fire-burner fa-3x"></i>
        </div>
        
        <div class="text-secondary fw-bold small ls-1 mb-1">PROFESSIONAL COOK</div>
        <h5 class="fw-bold mb-3">商店街のプロが手作り</h5>
        
        <p class="text-muted small mb-0 lh-sm">
          八百屋の野菜、肉屋のコロッケ。<br>
          コンビニとは違う「手作りの味」を<br>
          安心安全のバランスで。
        </p>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card h-100 border-0 shadow text-center py-4 px-3 rounded-4" style="background: rgba(255, 255, 255, 0.98);">
        <div class="position-absolute top-0 start-50 translate-middle">
          <span class="badge rounded-pill bg-danger border border-4 border-white shadow-sm px-3 py-2" style="font-size: 1rem;">STEP 3</span>
        </div>
        <div class="mt-4 mb-2 text-danger">
          <i class="fa-solid fa-box-open fa-3x"></i>
        </div>
        
        <div class="text-secondary fw-bold small ls-1 mb-1">PICK UP 24H</div>
        <h5 class="fw-bold mb-3">ロッカーで待たずに受取</h5>
        
        <p class="text-muted small mb-0 lh-sm">
          残業帰りや、お子様の迎えの後でも。<br>
          QRコードをかざすだけで<br>
          商店街は、「いらっしゃい、おかえり」を待ってます。
        </p>
      </div>
    </div>

  </div>
</section>

{% if sale_products %}
<section id="sale" class="container mb-5">
  <div class="d-flex justify-content-between align-items-end mb-3 text-white">
    <h2 class="h4 fw-bold m-0">
      <i class="fa-solid fa-fire text-warning me-2"></i>本日の特売
    </h2>
    <a href="{% url 'dicon_app:sale_list' %}" class="btn btn-outline-light btn-sm rounded-pill px-3">
      すべて見る &raquo;
    </a>
  </div>
  
  <div class="row row-cols-2 row-cols-lg-6 g-3">
    {% for product in sale_products %}
    <div class="col">
      <a href="{% url 'dicon_app:product_detail' product.pk %}" class="card h-100 border-0 shadow-sm text-decoration-none hover-scale" style="border-radius: 1rem;">
        <div class="position-relative">
          {% if product.image %}
            <img src="{{ product.image.url }}" class="card-img-top bg-light" alt="{{ product.name }}" style="height: 120px; object-fit: cover; border-radius: 1rem 1rem 0 0;">
          {% else %}
            <div class="bg-light d-flex align-items-center justify-content-center" style="height: 120px; border-radius: 1rem 1rem 0 0;">
              <i class="fa-solid fa-basket-shopping text-secondary fa-2x"></i>
            </div>
          {% endif %}
          <span class="position-absolute top-0 start-0 bg-danger text-white px-2 py-1 m-1 rounded-pill small fw-bold" style="font-size: 0.7rem;">SALE</span>
        </div>
        
        <div class="card-body p-3 pt-2 text-dark">
          <h6 class="card-title small fw-bold text-truncate mb-1">{{ product.name }}</h6>
          <div class="d-flex justify-content-between align-items-end">
            <span class="text-danger fw-bold">{{ product.sale_price }}円</span>
            <span class="small text-muted text-decoration-line-through">{{ product.price }}円</span>
          </div>
        </div>
      </a>
    </div>
    {% endfor %}
  </div>
</section>
{% endif %}

{% if recommended_sets %}
<section id="recommended-sets" class="container mb-5">
  {# ▼ text-dark を text-white に変更 #}
  <div class="d-flex justify-content-between align-items-end mb-4 text-white">
    <h2 class="h4 fw-bold m-0">
      {# ▼ アイコンの色も緑(success)から白(white)に変え見やすい #}
      <i class="fa-solid fa-utensils text-white me-2"></i>管理栄養士監修 おすすめ献立セット
    </h2>
    {# ▼ ボタンも黒枠(outline-dark)から白枠(outline-light)に変更 #}
    <a href="{% url 'dicon_app:set_list' %}" class="btn btn-outline-light btn-sm rounded-pill px-3 shadow-sm">
      すべて見る &raquo;
    </a>
  </div>

  <div class="row g-3 justify-content-center">
    {# views.pyから渡された recommended_sets をループ #}
    {% for set in recommended_sets %}
    <div class="col-md-6 col-lg-4">
      {# クリックしたら、そのセットの詳細ページへ移動 #}
      <a href="{% url 'dicon_app:set_detail' pk=set.pk %}" class="card h-100 border-0 shadow-sm hover-scale rounded-4 overflow-hidden text-decoration-none text-dark">
        
        <div class="position-relative">
          {# 画像があれば表示 #}
          {% if set.image %}
          <img src="{{ set.image.url }}" class="card-img-top" alt="{{ set.name }}" style="height: 200px; object-fit: cover;">
          {% else %}
          <div class="card-img-top bg-light d-flex align-items-center justify-content-center text-muted" style="height: 200px;">
              <i class="fa-solid fa-utensils fa-2x"></i>
          </div>
          {% endif %}
          
          {# バッジ：ここは固定で「監修済み」などを表示 #}
          <span class="position-absolute top-0 end-0 bg-success text-white px-3 py-1 m-2 rounded-pill fw-bold small shadow-sm">
              管理栄養士監修
          </span>
        </div>

        <div class="card-body p-3 d-flex flex-column">
          {# セット名 #}
          <h5 class="fw-bold fs-6 mb-2">{{ set.name }}</h5>
          {# 説明文 #}
          <p class="small text-muted mb-3 flex-grow-1">{{ set.description|truncatechars:40 }}</p>
          
          <div class="d-flex justify-content-between align-items-center mt-auto">
            {# 価格を表示（モデルにtotal_priceメソッドなどがある場合。なければ手動計算か、単に「お買い得」等） #}
            <span class="text-danger fw-bold fs-5">
                {% if set.total_price %}¥{{ set.total_price }}{% else %}CHECK{% endif %}
            </span>
            <span class="small fw-bold text-success">
                セット詳細を見る <i class="fa-solid fa-chevron-right ms-1"></i>
            </span>
          </div>
        </div>
      </a>
    </div>
    {% endfor %}
  </div>
</section>
{% endif %}

<section id="concierge" class="container mb-5">
  <div class="d-flex justify-content-between align-items-end mb-4 text-white">
    <h2 class="h4 fw-bold m-0">
      <i class="fa-solid fa-bell-concierge text-white me-2"></i>商店街おばちゃんコンシェルジュの厳選ピックアップ
    </h2>
    {# 必要であれば「すべて見る」ボタンなどをここに配置 #}
  </div>  
  
  <div class="section-card p-4 p-lg-5">
    
    <div class="row align-items-end mb-4">
        <div class="col-lg-8">
          <span class="badge bg-success mb-2 px-3">商店街の食のプロ監修</span>
          <h2 class="fw-bold fs-2 mb-2 text-dark">
              「忙しい！ごはん何しよ？！」<br>その悩み、Diconアプリが引き受けた！
          </h2>
          <p class="text-muted mb-0">
              新鮮食材の「献立セット」や、プロへの「相談」で、毎日の献立をもっと楽に自由に。
              <br>
              下ごしらえやレシピの悩みは、商店街のおばちゃんら（おっちゃんも）に任せてや〜！
            </p>
        </div>
        <div class="row g-3 justify-content-center">
        
          {# データベースから取得した home_pickups をループして表示 #}
          {% for pickup in home_pickups %}
          <div class="col-md-6 col-lg-4">
              {# リンク先は管理画面で登録したURL名（pickup.link_url_name）を使います #}
              <a href="{% url pickup.link_url_name %}" class="card h-100 border-0 shadow-sm hover-scale rounded-4 overflow-hidden text-decoration-none text-dark">
                  <div class="position-relative">
                      {# 画像があれば表示、なければダミー画像を表示 #}
                      {% if pickup.image %}
                      <img src="{{ pickup.image.url }}" 
                           class="card-img-top" alt="{{ pickup.title }}" style="height: 200px; object-fit: cover;">
                      {% else %}
                       <div class="card-img-top bg-light d-flex align-items-center justify-content-center text-muted" style="height: 200px;">
                          <i class="fa-solid fa-image fa-2x"></i>
                      </div>
                      {% endif %}
                      
                      {# バッジテキストがあれば表示 #}
                      {% if pickup.badge_text %}
                      <span class="position-absolute top-0 end-0 bg-danger text-white px-3 py-1 m-2 rounded-pill fw-bold small shadow-sm">
                          {{ pickup.badge_text }}
                      </span>
                      {% endif %}
                  </div>
                  <div class="card-body p-3 d-flex flex-column">
                      <h5 class="fw-bold fs-6 mb-2">{{ pickup.title }}</h5>
                      <p class="small text-muted mb-3 flex-grow-1">{{ pickup.description }}</p>
                      <div class="d-flex justify-content-between align-items-center mt-auto">
                          <span class="text-danger fw-bold fs-5">{{ pickup.price_text }}</span>
                          <span class="small fw-bold text-success">
                              {{ pickup.link_button_text }} <i class="fa-solid fa-chevron-right ms-1"></i>
                          </span>
                      </div>
                  </div>
              </a>
          </div>
          {% empty %}
          {# データが1つもない場合の表示 #}
          <div class="col-12 text-center text-muted py-5">
              <p>現在ピックアップ情報はありません。</p>
          </div>
          {% endfor %}
  
      </div>

      <a href="{% url 'dicon_app:concierge_list' %}" class="btn btn-dark rounded-pill px-5 py-2 shadow">
        おばちゃん（おっちゃん）コンシェルジュのおすすめ一覧へ
      </a>
    </div>

    <hr class="my-5 border-secondary border-opacity-10">

    <div class="row align-items-end mb-4">
        <div class="col-lg-8">
            <span class="text-warning fw-bold small ls-1">CONCIERGE</span>
            <h3 class="fw-bold m-0 text-dark">困ったときの“おせっかい”相談所</h3>
            <p class="text-muted small mt-2 mb-0">
                「予算2000円で」「魚をさばいて」「野菜の皮むいて」... 時間かかるとこは全部プロにお任せ！<br>
                チャットで伝えるだけで、あなた専用の下ごしらえ済み食材をご用意します。
            </p>
        </div>
        <div class="col-lg-4 text-lg-end d-none d-lg-block">
             <a href="{% url 'dicon_app:consult_menu' %}" class="btn btn-outline-warning text-dark rounded-pill px-4 btn-sm fw-bold">
                すべての相談メニュー <i class="fa-solid fa-chevron-right ms-1"></i>
            </a>
        </div>
    </div>

    <div class="row row-cols-2 row-cols-lg-4 g-3">
    
      {% for item in consultation_items %}
      <div class="col">
          <a href="{% url 'dicon_app:consult_home' %}?preset={{ item.preset_id }}" 
             class="card h-100 border-0 shadow-sm hover-scale text-decoration-none text-dark bg-light">
              
              {% if item.image %}
              <img src="{{ item.image.url }}" 
                   class="card-img-top rounded-top" 
                   style="height: 140px; object-fit: cover;" 
                   alt="{{ item.title }}">
              {% else %}
              <div class="bg-secondary text-white d-flex align-items-center justify-content-center rounded-top" style="height: 140px;">
                  <i class="fa-solid fa-image fa-2x"></i>
              </div>
              {% endif %}
  
              <div class="card-body p-3">
                  <h6 class="fw-bold small mb-2">{{ item.title }}</h6>
                  <p class="text-muted mb-0" style="font-size: 0.75rem; line-height: 1.4;">
                      {{ item.description|truncatechars:40 }}
                  </p>
              </div>
              
              <div class="card-footer bg-transparent border-0 pt-0 pb-3">
                  <span class="btn btn-light text-{{ item.color_theme }} w-100 fw-bold rounded-pill btn-sm shadow-sm">
                      相談する
                  </span>
              </div>
          </a>
      </div>
      {% empty %}
      <div class="col-12 text-center py-5">
          <p class="text-muted">現在、相談メニューを準備中です。</p>
      </div>
      {% endfor %}
  
  </div>

    <div class="text-center mt-4 d-lg-none">
        <a href="{% url 'dicon_app:consult_menu' %}" class="btn btn-outline-warning text-dark rounded-pill px-4 w-100 fw-bold">
            すべての相談メニューへ
        </a>
    </div>

  </div>

</section>

<section id="locker" class="container mb-5">
  <div class="section-card p-0 text-white overflow-hidden rounded-4 shadow-lg" 
     style="background: linear-gradient(135deg, #2E7D32 0%, #66BB6A 100%);">
    <div class="row g-0 align-items-center">
      
      <div class="col-lg-6 p-5 position-relative z-1">
        <span class="badge bg-warning text-dark fw-bold mb-3 px-3 py-2 rounded-pill shadow-sm animate-pulse">
            <i class="fa-regular fa-clock me-1"></i>24時間受取OK
        </span>
        
        <h2 class="fw-bold display-6 mb-4" style="font-family: 'Mochiy Pop One', sans-serif;">
            お店の閉店時間は、<br>
            気にしなくて大丈夫。
        </h2>
        
        <p class="text-white opacity-90 mb-4" style="line-height: 1.8;">
          残業帰りでも、お子さんのお迎え等の前後でも。<br>
          商店街に設置された<strong>「専用冷蔵ロッカー」</strong>が、あなたの冷蔵庫代わりになります。<br>
          受け取りは、QRコードをかざすだけ。
        </p>

        <div class="d-flex gap-3 mb-4">
            <div class="d-flex align-items-center bg-white bg-opacity-10 px-3 py-2 rounded-3 border border-white border-opacity-10">
                <i class="fa-solid fa-snowflake text-info fs-5 me-2"></i>
                <div class="lh-1 text-start">
                    <span class="d-block fw-bold small">冷蔵</span>
                    <span style="font-size: 0.6rem; opacity: 0.7;">新鮮キープ</span>
                </div>
            </div>
            <div class="d-flex align-items-center bg-white bg-opacity-10 px-3 py-2 rounded-3 border border-white border-opacity-10">
                <i class="fa-solid fa-mobile-screen text-warning fs-5 me-2"></i>
                <div class="lh-1 text-start">
                    <span class="d-block fw-bold small">スマホ</span>
                    <span style="font-size: 0.6rem; opacity: 0.7;">かざすだけ</span>
                </div>
            </div>
            <div class="d-flex align-items-center bg-white bg-opacity-10 px-3 py-2 rounded-3 border border-white border-opacity-10">
                <i class="fa-solid fa-user-slash text-success fs-5 me-2"></i>
                <div class="lh-1 text-start">
                    <span class="d-block fw-bold small">非対面</span>
                    <span style="font-size: 0.6rem; opacity: 0.7;">気楽に</span>
                </div>
            </div>
        </div>

        <span class="badge bg-white text-success fw-bold mb-3 px-3 py-2 rounded-pill shadow-sm animate-pulse">
          <i class="fa-solid fa-circle-play me-2"></i>使い方を見る
        </a>
      </div>

      <div class="col-lg-6 position-relative overflow-hidden d-flex align-items-center justify-content-center" style="min-height: 480px;">
        
        <div class="position-absolute top-0 end-0 w-100 h-100" style="background: radial-gradient(circle at 70% 30%, rgba(255, 193, 7, 0.15) 0%, transparent 60%);"></div>

        <div class="position-absolute w-100 h-100 opacity-10" style="background-image: linear-gradient(#fff 1px, transparent 1px), linear-gradient(90deg, #fff 1px, transparent 1px); background-size: 50px 50px;"></div>

        <div class="position-relative shadow-lg" style="width: 260px; height: 500px; background: #000; border-radius: 40px; border: 8px solid #1a1a1a; box-shadow: 0 20px 50px -10px rgba(0,0,0,0.6);">
          
          <div class="position-absolute top-0 start-50 translate-middle-x bg-dark rounded-bottom-4 z-3" style="width: 40%; height: 25px;"></div>

          <div class="w-100 h-100 bg-white overflow-hidden position-relative d-flex flex-column" style="border-radius: 32px;">
            
            <div class="bg-white border-bottom pt-4 pb-2 px-3 d-flex align-items-center justify-content-between">
                <i class="fa-solid fa-bars text-secondary"></i>
                <span class="fw-bold small">受取キー</span>
                <i class="fa-regular fa-bell text-secondary"></i>
            </div>
            
            <div class="flex-grow-1 d-flex flex-column align-items-center justify-content-center px-4 bg-light">
                
                <div class="bg-white p-4 rounded-4 shadow-sm w-100 text-center position-relative mb-3">
                    <p class="small text-muted fw-bold mb-2">読み取りリーダーにかざす</p>
                    
                    <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=DiconAppLockerUnlockKey8823&color=111111" 
                         alt="QR Code" class="img-fluid mb-2" style="width: 140px; opacity: 0.9;">
                    
                    <div class="position-absolute start-0 w-100 bg-danger opacity-25 shadow-sm" style="height: 4px; top: 20%; animation: scan 2.5s infinite ease-in-out;"></div>
                    
                    <div class="mt-2 text-dark fw-bold ls-2" style="font-family: monospace;">KEY: 8823</div>
                </div>

                <div class="d-flex align-items-center justify-content-center gap-2 w-100 mb-2">
                     <span class="badge bg-success bg-opacity-10 text-success border border-success px-3 py-2 rounded-pill w-100">
                        <i class="fa-solid fa-check-circle me-1"></i>受取準備完了
                     </span>
                </div>
                
                <div class="bg-dark text-white rounded-3 p-2 w-100 text-center small">
                    <i class="fa-solid fa-box-open me-2 text-warning"></i>BOX番号: <span class="fw-bold fs-6">B-05</span>
                </div>

            </div>

            <div class="p-3 bg-white border-top">
                <button class="btn btn-danger w-100 rounded-pill fw-bold py-2 shadow-sm hover-scale">
                    <i class="fa-solid fa-lock-open me-2"></i>解錠する
                </button>
            </div>

          </div>
        </div>

        <div class="position-absolute bottom-0 end-0 p-5 text-white" style="margin-right: -20px; margin-bottom: 20px; animation: floatHand 3s infinite ease-in-out;">
            <i class="fa-solid fa-hand-pointer fa-4x text-warning" style="transform: rotate(-30deg); filter: drop-shadow(0 5px 15px rgba(0,0,0,0.5));"></i>
        </div>

      </div>

    </div>
  </div>
</section>

<style>
@keyframes scan {
    0% { top: 20%; opacity: 0.8; }
    50% { top: 70%; opacity: 0.8; }
    100% { top: 20%; opacity: 0.8; }
}
@keyframes floatHand {
    0%, 100% { transform: translateY(0) rotate(-30deg); }
    50% { transform: translateY(-15px) rotate(-30deg); }
}
</style>

{% if upcoming_events or regular_events %}
<section id="event" class="container mb-5">
  
  <div class="section-card p-4 p-lg-5 bg-white shadow-sm rounded-4">

    <div class="text-center mb-5">
      <span class="badge bg-warning text-dark px-3 py-2 rounded-pill mb-2 shadow-sm">FUN! FUN!</span>
      <h2 class="fw-bold display-6 text-dark" style="font-family: 'Mochiy Pop One', sans-serif;">
        週末、どこいく？<br>商店街で遊ぼ！
      </h2>
      <p class="text-muted mt-3">
        マルシェ、夜市、ヒーローショー。<br>
        いつもの通りが「テーマパーク」に変わる日。
      </p>
    </div>

    <div class="row g-4">
      {% for event in upcoming_events %}
        <div class="col-12 col-md-6">
          <a href="{% url 'dicon_app:event_detail' slug=event.slug %}" class="text-decoration-none text-dark">
            <div class="card h-100 border hover-scale rounded-4 overflow-hidden bg-white">
              
              <div class="ratio ratio-16x9">
                {% if event.image %}
                  <img src="{{ event.image.url }}" class="w-100 h-100 object-fit-cover" alt="{{ event.title }}">
                {% else %}
                  <div class="w-100 h-100 bg-secondary d-flex align-items-center justify-content-center text-white">
                    <i class="fa-regular fa-calendar fa-3x"></i>
                  </div>
                {% endif %}
              </div> <div class="card-body p-4 bg-white">
                <small class="text-danger fw-bold d-block mb-2">
                  <i class="fa-regular fa-clock me-1"></i>
                  {% if event.start_date %}
                    {{ event.start_date|date:"n月j日(D)" }}
                  {% else %}
                    近日開催
                  {% endif %}
                </small>
                <h4 class="card-title fw-bold mb-2">{{ event.title }}</h4>
                <p class="card-text text-muted small mb-0">
                  {{ event.description|truncatechars:50 }}
                </p>
              </div>
            </div>
          </a>
        </div>
      {% empty %}
        <div class="col-12 text-center py-5">
          <p class="text-muted">現在予定されているイベントはありません。</p>
        </div>
      {% endfor %}
    </div>
    
    <div class="text-center mt-5">
      <a href="{% url 'dicon_app:event_list' %}" class="btn btn-outline-dark rounded-pill px-4">
        イベント一覧を見る
      </a>
    </div>

  </div> 
</section>
{% endif %}

<!-- <section id="partner" class="container mb-5">
    
  <div class="section-card p-4 p-lg-5 bg-white shadow-sm rounded-4">
      
      <div class="text-center mb-5">
          <span class="badge bg-primary bg-opacity-10 text-primary mb-2 px-3 py-2 rounded-pill fw-bold">COMMUNITY</span>
          <h2 class="fw-bold display-6 mb-3 text-dark" style="letter-spacing: 0.05em;">
              商店街は、「買う場所」から<br>「頼れる場所」へ。
          </h2>
          <p class="text-muted lead" style="font-size: 1rem;">
              お買い物以外のお困りごとも、地元のつながりで解決します。
          </p>
      </div>

      <div class="row g-4 align-items-stretch">
          
          <div class="col-lg-6 d-flex flex-column">
              <div class="h-100 d-flex flex-column justify-content-center">
                  <div class="mb-4">
                      <h3 class="fw-bold mb-3 text-dark">
                          <span class="text-primary"><i class="fa-solid fa-hand-holding-heart me-2"></i></span>
                          「ちょっと助けて！」に応えます。
                      </h3>
                      <p class="text-muted">
                          遠くの親戚より、近くの商店街。<br>
                          「こんなこと頼める？」という潜在的なお悩みも、認定パートナーにお任せください。
                      </p>
                  </div>

                  <div class="d-flex flex-column gap-3 mb-4">
                      <div class="d-flex align-items-center bg-light p-3 rounded-4 border border-white">
                          <div class="bg-white text-danger rounded-circle p-3 me-3 shadow-sm" style="min-width: 50px; text-align: center;">
                              <i class="fa-solid fa-user-nurse fs-5"></i>
                          </div>
                          <div>
                              <h6 class="fw-bold mb-1 text-dark">親の見守り・介護サポート</h6>
                              <p class="small text-muted mb-0">「実家の親、元気かな？」お弁当配達のついでに、顔を見て安否確認します。</p>
                          </div>
                      </div>
                      <div class="d-flex align-items-center bg-light p-3 rounded-4 border border-white">
                          <div class="bg-white text-primary rounded-circle p-3 me-3 shadow-sm" style="min-width: 50px; text-align: center;">
                              <i class="fa-solid fa-screwdriver-wrench fs-5"></i>
                          </div>
                          <div>
                              <h6 class="fw-bold mb-1 text-dark">住まいのSOS・修理</h6>
                              <p class="small text-muted mb-0">水漏れ、鍵の紛失、網戸の張り替え。地元の職人が「すぐ」駆けつけます。</p>
                          </div>
                      </div>
                       <div class="d-flex align-items-center bg-light p-3 rounded-4 border border-white">
                          <div class="bg-white text-success rounded-circle p-3 me-3 shadow-sm" style="min-width: 50px; text-align: center;">
                              <i class="fa-solid fa-truck-ramp-box fs-5"></i>
                          </div>
                          <div>
                              <h6 class="fw-bold mb-1 text-dark">力仕事・スマホ相談</h6>
                              <p class="small text-muted mb-0">家具の移動、電球交換、スマホの操作。「誰に頼めば？」を解決。</p>
                          </div>
                      </div>
                  </div>

                  <div class="mt-auto">
                       <a href="{% url 'dicon_app:partner_list' %}" class="btn btn-outline-primary rounded-pill w-100 py-3 fw-bold hover-scale">
                          認定パートナーを探す <i class="fa-solid fa-chevron-right ms-2"></i>
                      </a>
                  </div>
              </div>
          </div>

          <div class="col-lg-6">
              <div class="card h-100 border-0 rounded-4 overflow-hidden shadow hover-scale text-white position-relative" 
                   style="background: url('https://images.unsplash.com/photo-1556740758-90de374c12ad?auto=format&fit=crop&w=800&q=80') center/cover; min-height: 400px;">
                  
                  <div class="position-absolute top-0 start-0 w-100 h-100 bg-dark opacity-75"></div>
                  
                  <div class="card-body p-4 p-lg-5 position-relative z-1 d-flex flex-column text-center justify-content-center">
                      <div class="mb-3">
                           <span class="badge bg-warning text-dark mb-3 px-3 py-2 rounded-pill shadow-sm animate-pulse">
                              <i class="fa-solid fa-shop me-2"></i>3店舗 OPEN!
                          </span>
                      </div>
                      <h3 class="fw-bold mb-3 display-6" style="font-family: 'Mochiy Pop One', sans-serif; text-shadow: 0 2px 4px rgba(0,0,0,0.5);">
                          空き店舗、<br>こうなってます。
                      </h3>
                      
                      <p class="text-white fw-bold mb-4" style="font-size: 1.1rem; line-height: 1.8; text-shadow: 0 2px 4px rgba(0,0,0,0.5);">
                          古い金物屋が「古着バー」に。<br>
                          時計屋さんが「レトロ喫茶」に。<br>
                          あなたの夢も、この街で叶えませんか？
                      </p>

                      <div class="row g-2 mb-4 justify-content-center">
                          <div class="col-4">
                              <img src="https://images.unsplash.com/photo-1554118811-1e0d58224f24?auto=format&fit=crop&w=150&q=80" class="rounded-3 shadow-sm w-100 border border-2 border-white" alt="Cafe" style="height: 70px; object-fit: cover;">
                          </div>
                          <div class="col-4">
                              <img src="https://images.unsplash.com/photo-1524316885361-b1b6c0e5a6b0?auto=format&fit=crop&w=150&q=80" class="rounded-3 shadow-sm w-100 border border-2 border-white" alt="Bookstore" style="height: 70px; object-fit: cover;">
                          </div>
                           <div class="col-4">
                              <img src="https://images.unsplash.com/photo-1595856488331-507949392289?auto=format&fit=crop&w=150&q=80" class="rounded-3 shadow-sm w-100 border border-2 border-white" alt="Shop" style="height: 70px; object-fit: cover;">
                          </div>
                      </div>

                       <div class="mt-auto">
                           <a href="{% url 'dicon_app:vacant_store' %}" class="btn btn-warning text-dark rounded-pill w-100 py-3 fw-bold shadow hover-scale">
                              空き物件情報を見る <i class="fa-solid fa-chevron-right ms-2"></i>
                          </a>
                      </div>
                  </div>
              </div>
          </div>
      </div>
  </div>
</section> -->
<section id="partner" class="container mb-5">
  <div class="section-card p-4 p-lg-5">
      
      <div class="text-center mb-5">
          <span class="badge bg-primary bg-opacity-10 text-primary mb-2 px-3 py-2 rounded-pill fw-bold">COMMUNITY</span>
          <h2 class="fw-bold display-6 mb-3 text-dark">
              商店街は、買う場所から<br>もっと頼れる場所へ。
          </h2>
          <p class="text-muted lead" style="font-size: 1rem;">
              お買い物以外のお困りごとも、地元の認定パートナーが解決します！
          </p>
      </div>

      <div class="row g-4">
          {% for partner in partners %}
          <div class="col-lg-6">
              <div class="card h-100 border-0 shadow-sm rounded-4 overflow-hidden hover-scale bg-light bg-opacity-50">
                  <div class="row g-0 h-100 align-items-center">
                      <div class="col-4 p-3 text-center">
                          {% if partner.image %}
                              <img src="{{ partner.image.url }}" alt="{{ partner.name }}" class="rounded-circle shadow-sm object-fit-cover" style="width: 100px; height: 100px;">
                          {% else %}
                              <div class="bg-white text-primary rounded-circle shadow-sm d-flex align-items-center justify-content-center mx-auto" style="width: 100px; height: 100px;">
                                  <i class="fa-solid fa-user-check fs-2"></i>
                              </div>
                          {% endif %}
                      </div>
                      <div class="col-8">
                          <div class="card-body p-3">
                              <h5 class="fw-bold text-dark mb-1">{{ partner.name }}</h5>
                              <p class="small text-muted mb-3" style="line-height: 1.5;">
                                {{ partner.description|linebreaksbr|truncatechars:100 }}
                              </p>
                              <div class="text-end">
                                  <a href="{% url 'dicon_app:partner_list' %}" class="btn btn-outline-primary btn-sm rounded-pill px-3 fw-bold">
                                      詳しく見る <i class="fa-solid fa-chevron-right ms-1"></i>
                                  </a>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
          {% empty %}
          <div class="col-12 text-center text-muted py-5">
              <p>現在、認定パートナーを募集中です。</p>
          </div>
          {% endfor %}
    </div>

    <div class="text-center mt-5">
        <a href="{% url 'dicon_app:partner_list' %}" class="btn btn-outline-primary rounded-pill px-5 py-3 fw-bold hover-scale shadow-sm" style="border-width: 2px;">
            認定事業者一覧へ <i class="fa-solid fa-chevron-right ms-2"></i>
        </a>
    </div>
    </section>

  </div>
</section>

<section id="vacant-store" class="container mb-5">
  <div class="section-card p-4 p-lg-5">
      
      <div class="text-center mb-5">
          <span class="badge bg-warning text-dark mb-2 px-3 py-2 rounded-pill fw-bold">VACANT STORE</span>
          <h2 class="fw-bold display-6 mb-3 text-dark">
              この街で、あなたの夢を。<br>空き店舗、こうなってます。
          </h2>
      </div>

      <div class="card border-0 rounded-4 overflow-hidden shadow-lg text-white position-relative" 
           style="background: url('https://images.unsplash.com/photo-1556740758-90de374c12ad?auto=format&fit=crop&w=1200&q=80') center/cover; min-height: 450px;">
          
          <div class="position-absolute top-0 start-0 w-100 h-100 bg-dark opacity-75"></div>
          
          <div class="card-body p-4 p-lg-5 position-relative z-1 d-flex flex-column text-center justify-content-center h-100">
              <p class="text-white fw-bold mb-4 lead" style="line-height: 2; text-shadow: 0 2px 4px rgba(0,0,0,0.5);">
                  古い金物屋が「古着バー」に。<br>
                  時計屋さんが「レトロ喫茶」に。<br>
                  新しい「おせっかい」が、この街を面白くしています。
              </p>

              <div class="row g-3 mb-5 justify-content-center">
                  <div class="col-4 col-md-2">
                      <img src="https://images.unsplash.com/photo-1554118811-1e0d58224f24?auto=format&fit=crop&w=200&q=80" class="rounded-4 w-100 border border-3 border-white shadow" alt="Cafe" style="height: 100px; object-fit: cover;">
                  </div>
                  <div class="col-4 col-md-2">
                      <img src="https://images.unsplash.com/photo-1524316885361-b1b6c0e5a6b0?auto=format&fit=crop&w=200&q=80" class="rounded-4 w-100 border border-3 border-white shadow" alt="Book" style="height: 100px; object-fit: cover;">
                  </div>
                  <div class="col-4 col-md-2">
                      <img src="https://images.unsplash.com/photo-1595856488331-507949392289?auto=format&fit=crop&w=200&q=80" class="rounded-4 w-100 border border-3 border-white shadow" alt="Shop" style="height: 100px; object-fit: cover;">
                  </div>
              </div>

              <div class="text-center">
                  <a href="{% url 'dicon_app:vacant_store' %}" class="btn btn-warning text-dark rounded-pill px-5 py-3 fw-bold shadow-lg hover-scale">
                      空き物件情報を見る <i class="fa-solid fa-chevron-right ms-2"></i>
                  </a>
              </div>
          </div>
      </div>

  </div>
</section>

{% endblock %}