{% extends "base.html" %}
{% load static %}

{% block title %}ホーム{% endblock %}

{% block content %}

<style>
  /* 全体の背景色（広島レッド）とドット柄 */
  body {
    background-color: #b71c1c !important;
    background-image: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
    background-size: 20px 20px;
    color: white;
  }
  
  /* セクションごとの背景（白ベース） */
  .section-card {
    background-color: #f8f9fa;
    color: #333;
    border-radius: 1.5rem;
    overflow: hidden;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    margin-bottom: 3rem;
  }

  /* ヒーロー画像のカルーセル矢印を見やすく */
  .carousel-control-prev-icon,
  .carousel-control-next-icon {
    filter: drop-shadow(0px 0px 3px rgba(0,0,0,0.5));
  }
  
  /* アニメーション */
  .animate-pulse { animation: pulse 2s infinite; }
  @keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
  }
  .hover-scale { transition: transform 0.2s; }
  .hover-scale:hover { transform: scale(1.03); }
</style>

<div class="bg-dark text-white text-center py-1">
  <small style="font-size: 0.75rem;">【Demo】本サイトは学校演習用のデモ画面です（架空のサービス）</small>
</div>
<section class="position-relative w-100 overflow-hidden d-flex align-items-center justify-content-center mb-5" 
         style="min-height: 600px; background-color: #333;">
  
         {% if slides and slides.0.image %}
         <div class="position-absolute top-0 start-0 w-100 h-100" 
              style="background-image: url('{{ slides.0.image.url }}'); background-size: cover; background-position: center; z-index: 0;">
         </div>
       {% else %}
         <div class="position-absolute top-0 start-0 w-100 h-100" 
              style="background-image: url('{% static 'img/shopping_street_bg.jpg' %}'); background-size: cover; background-position: center; z-index: 0;">
         </div>
       {% endif %}
     
       <div class="position-absolute top-0 start-0 w-100 h-100 bg-dark" style="opacity: 0.3; z-index: 1;"></div>

  <div class="container position-relative text-center z-2 px-3 py-5"><div class="mb-4">
    <!-- <p class="text-white fw-bold ls-2 mb-3 d-inline-block border-bottom border-danger border-3" style="font-size: clamp(0.9rem, 2vw, 1.2rem);">
        <i class="fa-solid fa-bell-concierge me-2 text-danger"></i>商店街で<br>あったらいいな！の買い物アプリやねん<br>いっぺん使ってみて〜
    </p> -->

    <div class="d-flex justify-content-center align-items-end mb-3">
      <img src="{% static 'img/hero_smartphone.png' %}" 
           alt="スマホで注文" 
           style="width: 150px; max-width: 30vw; height: auto; filter: drop-shadow(0 5px 15px rgba(0,0,0,0.6)); transform: rotate(-8deg) translateX(5px); z-index: 2;">
      
      <img src="{% static 'img/hero_locker.png' %}" 
           alt="ロッカーで受取" 
           style="width: 180px; max-width: 35vw; height: auto; filter: drop-shadow(0 5px 15px rgba(0,0,0,0.6)); transform: translateX(-5px); z-index: 1;">
  </div>

    <h1 class="text-white fw-bold mb-4" style="font-family: 'Mochiy Pop One', sans-serif; text-shadow: 0 4px 15px rgba(0,0,0,0.9); font-size: clamp(1.5rem, 4.5vw, 3.5rem); line-height: 1.3;">
      アプリで
      <span class="d-inline-block text-warning mx-1" 
            style="font-size: 1.2em; text-shadow: none;">注文</span>、<br class="d-md-none">
      
      ロッカーで
      <span class="d-inline-block mx-1" 
            style="color: #ff3547; font-size: 1.2em; text-shadow: none;">受取</span>
    </h1>
    
    <h2 class="text-white fw-bold mb-4" style="font-family: 'Mochiy Pop One', sans-serif; text-shadow: 0 4px 15px rgba(0,0,0,0.8); font-size: clamp(1.5rem, 4vw, 3.5rem); line-height: 1.4;">
        商店街は18時までやけど、<br>
        ロッカーは<span class="text-danger bg-white px-3 rounded-3" style="font-size: 0.9em; text-shadow: none; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">24時間</span>やってます。
    </h2>
    
    <p class="text-white fw-bold opacity-95 mx-auto" style="font-size: clamp(1rem, 2.5vw, 1.3rem); text-shadow: 0 2px 8px rgba(0,0,0,0.9); line-height: 1.9; max-width: 800px;">
        <span class="text-warning">「ハンバーグのタネだけ、どっさりほしい」</span><br>
        <span class="text-warning">「ごぼうのあく抜きささがき、一掴みほしい」</span><br>
        <!-- <span class="text-warning">「子ども用にカレイの煮付け薄味で１尾と、大人用の味付け２尾」</span><br> -->
        ニッチな注文も、チャットで店に相談してや!<br>
        駅前の商店街で、「あなた専用」の注文とタイミングで受け取ってな。
    </p>
</div>
  
    <div class="mt-5 d-flex flex-column flex-sm-row justify-content-center gap-3">
      <a href="{% url 'dicon_app:shop_list' %}" class="btn btn-danger btn-lg rounded-pill px-5 py-3 shadow fw-bold hover-scale border-2 border-white" style="font-size: 1.2rem;">
        <i class="fa-solid fa-store me-2"></i>お店をのぞく
      </a>
      <a href="{% url 'dicon_app:consult_home' %}" class="btn btn-outline-light btn-lg rounded-pill px-5 py-3 shadow fw-bold hover-scale" style="font-size: 1.2rem; border-width: 2px;">
        <i class="fa-regular fa-comments me-2"></i>チャットで相談
      </a>
    </div>
  
  </div>
</section>

<section class="container mb-5" style="margin-top: -3rem; position: relative; z-index: 10;">
  <div class="row g-3 justify-content-center">
    
    <div class="col-md-4">
      <div class="card h-100 border-0 shadow text-center py-4 px-3 rounded-4" style="background: rgba(255, 255, 255, 0.98);">
        <div class="position-absolute top-0 start-50 translate-middle">
          <span class="badge rounded-pill bg-danger border border-4 border-white shadow-sm px-3 py-2" style="font-size: 1rem;">STEP 1</span>
        </div>
        <div class="mt-4 mb-2 text-danger">
          <i class="fa-solid fa-mobile-screen-button fa-3x"></i>
        </div>
        
        <div class="text-secondary fw-bold small ls-1 mb-1">ORDER & CHAT</div>
        <h5 class="fw-bold mb-3">スマホで注文・相談</h5>
        
        <p class="text-muted small mb-0 lh-sm">
          通勤時間や隙間時間にポチッ。<br>
          「子供が食べるから薄味で」<br>
          そんなニーズもチャットや電話でOK。
        </p>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card h-100 border-0 shadow text-center py-4 px-3 rounded-4" style="background: rgba(255, 255, 255, 0.98);">
        <div class="position-absolute top-0 start-50 translate-middle">
          <span class="badge rounded-pill bg-danger border border-4 border-white shadow-sm px-3 py-2" style="font-size: 1rem;">STEP 2</span>
        </div>
        <div class="mt-4 mb-2 text-danger">
          <i class="fa-solid fa-fire-burner fa-3x"></i>
        </div>
        
        <div class="text-secondary fw-bold small ls-1 mb-1">PROFESSIONAL COOK</div>
        <h5 class="fw-bold mb-3">商店街のプロが手作り</h5>
        
        <p class="text-muted small mb-0 lh-sm">
          八百屋の野菜、肉屋のコロッケ。<br>
          コンビニとは違う「手作りの味」を<br>
          安心安全のバランスで。
        </p>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card h-100 border-0 shadow text-center py-4 px-3 rounded-4" style="background: rgba(255, 255, 255, 0.98);">
        <div class="position-absolute top-0 start-50 translate-middle">
          <span class="badge rounded-pill bg-danger border border-4 border-white shadow-sm px-3 py-2" style="font-size: 1rem;">STEP 3</span>
        </div>
        <div class="mt-4 mb-2 text-danger">
          <i class="fa-solid fa-box-open fa-3x"></i>
        </div>
        
        <div class="text-secondary fw-bold small ls-1 mb-1">PICK UP 24H</div>
        <h5 class="fw-bold mb-3">ロッカーで待たずに受取</h5>
        
        <p class="text-muted small mb-0 lh-sm">
          残業帰りや、お子様の迎えの後でも。<br>
          QRコードをかざすだけで<br>
          商店街は、「いらっしゃい、おかえり」を待ってます。
        </p>
      </div>
    </div>

  </div>
</section>

{% if sale_products %}
<section id="sale-section" class="container mb-5">
  <div class="d-flex justify-content-between align-items-end mb-3 text-white">
    <h2 class="h4 fw-bold m-0">
      <i class="fa-solid fa-fire text-warning me-2"></i>本日の特売
    </h2>
    <a href="{% url 'dicon_app:sale_list' %}" class="btn btn-outline-light btn-sm rounded-pill px-3">
      すべて見る &raquo;
    </a>
  </div>
  
  <div class="row row-cols-2 row-cols-lg-6 g-3">
    {% for product in sale_products %}
    <div class="col">
      <a href="{% url 'dicon_app:product_detail' product.pk %}" class="card h-100 border-0 shadow-sm text-decoration-none hover-scale" style="border-radius: 1rem;">
        <div class="position-relative">
          {% if product.image %}
            <img src="{{ product.image.url }}" class="card-img-top bg-light" alt="{{ product.name }}" style="height: 120px; object-fit: cover; border-radius: 1rem 1rem 0 0;">
          {% else %}
            <div class="bg-light d-flex align-items-center justify-content-center" style="height: 120px; border-radius: 1rem 1rem 0 0;">
              <i class="fa-solid fa-basket-shopping text-secondary fa-2x"></i>
            </div>
          {% endif %}
          <span class="position-absolute top-0 start-0 bg-danger text-white px-2 py-1 m-1 rounded-pill small fw-bold" style="font-size: 0.7rem;">SALE</span>
        </div>
        
        <div class="card-body p-3 pt-2 text-dark">
          <h6 class="card-title small fw-bold text-truncate mb-1">{{ product.name }}</h6>
          <div class="d-flex justify-content-between align-items-end">
            <span class="text-danger fw-bold">{{ product.sale_price }}円</span>
            <span class="small text-muted text-decoration-line-through">{{ product.price }}円</span>
          </div>
        </div>
      </a>
    </div>
    {% endfor %}
  </div>
</section>
{% endif %}

{% if recommended_sets %}
<section id="recommended-sets" class="container mb-5">
  {# ▼ text-dark を text-white に変更 #}
  <div class="d-flex justify-content-between align-items-end mb-4 text-white">
    <h2 class="h4 fw-bold m-0">
      {# ▼ アイコンの色も緑(success)から白(white)に変え見やすい #}
      <i class="fa-solid fa-utensils text-white me-2"></i>管理栄養士監修 おすすめ献立セット
    </h2>
    {# ▼ ボタンも黒枠(outline-dark)から白枠(outline-light)に変更 #}
    <a href="{% url 'dicon_app:set_list' %}" class="btn btn-outline-light btn-sm rounded-pill px-3 shadow-sm">
      すべて見る &raquo;
    </a>
  </div>

  <div class="row g-3 justify-content-center">
    {# views.pyから渡された recommended_sets をループ #}
    {% for set in recommended_sets %}
    <div class="col-md-6 col-lg-4">

      {# クリックしたら、そのセットの詳細ページへ移動 #}     
      <a href="{% url 'dicon_app:set_detail' pk=set.pk %}" class="card h-100 border-0 shadow-sm hover-scale rounded-4 overflow-hidden text-decoration-none text-dark">  
        
        <div class="position-relative">
          {# 画像があれば表示 #}
          {% if set.image %}
          <img src="{{ set.image.url }}" class="card-img-top" alt="{{ set.name }}" style="height: 200px; object-fit: cover;">
          {% else %}
          <div class="card-img-top bg-light d-flex align-items-center justify-content-center text-muted" style="height: 200px;">
              <i class="fa-solid fa-utensils fa-2x"></i>
          </div>
          {% endif %}
          
          {# バッジ：ここは固定で「監修済み」などを表示 #}
          <span class="position-absolute top-0 end-0 bg-success text-white px-3 py-1 m-2 rounded-pill fw-bold small shadow-sm">
              管理栄養士監修
          </span>
        </div>

        <div class="card-body p-3 d-flex flex-column">
          {# セット名 #}
          <h5 class="fw-bold fs-6 mb-2">{{ set.name }}</h5>
          {# 説明文 #}
          <p class="small text-muted mb-3 flex-grow-1">{{ set.description|truncatechars:40 }}</p>
          
          <div class="d-flex justify-content-between align-items-center mt-auto">
            {# 価格を表示（モデルにtotal_priceメソッドなどがある場合。なければ手動計算か、単に「お買い得」等） #}
            <span class="text-danger fw-bold fs-5">
                {% if set.total_price %}¥{{ set.total_price }}{% else %}CHECK{% endif %}
            </span>
            <span class="small fw-bold text-success">
                セット詳細を見る <i class="fa-solid fa-chevron-right ms-1"></i>
            </span>
          </div>
        </div>
      </a>
    </div>
    {% endfor %}
  </div>
</section>
{% endif %}

<section id="concierge" class="container mb-5">
  <div class="d-flex justify-content-between align-items-end mb-4 text-white">
    <h2 class="h4 fw-bold m-0">
      <i class="fa-solid fa-bell-concierge text-white me-2"></i>商店街おばちゃんコンシェルジュの厳選ピックアップ
    </h2>
    {# 必要であれば「すべて見る」ボタンなどをここに配置 #}
  </div>  
  
  <div class="section-card p-4 p-lg-5">
    
    <div class="row align-items-end mb-4">
        <div class="col-lg-8">
          <span class="badge bg-success mb-2 px-3">商店街の食のプロ監修</span>
          <h2 class="fw-bold fs-2 mb-2 text-dark">
              「忙しい~ごはん何しよ？！」<br>その悩み、Diconアプリにおまかせ〜
          </h2>
          <p class="text-muted mb-0">
              新鮮食材の「献立セット」や、プロへの「相談」で、毎日の献立をもっと楽に自由に。
              <br>
              下ごしらえやレシピの悩みは、商店街のおばちゃんら（おっちゃんも）に任せてや〜！
            </p>
        </div>
        <div class="row g-3 justify-content-center">
        
          {# データベースから取得した home_pickups をループして表示 #}
          {% for pickup in home_pickups %}
    <div class="col-md-6 col-lg-4">
        {# 管理画面の「リンク先のURL名」を使って詳細ページへ飛ばします #}
        {# pickup.link_url_name と書くことで、管理画面に入れた「/concierge/」が反映されます #}
<a href="{{ pickup.link_url_name }}" class="card h-100 border-0 shadow-sm hover-scale rounded-4 overflow-hidden text-decoration-none text-dark">
            <div class="position-relative">
                <img src="{{ pickup.image.url }}" class="card-img-top" alt="{{ pickup.title }}" style="height: 200px; object-fit: cover;">
                
                {# おばちゃんからのメッセージをバッジに！ #}
                <span class="position-absolute top-0 end-0 bg-danger text-white px-3 py-1 m-2 rounded-pill fw-bold small shadow-sm">
                    おばちゃん厳選！
                </span>
            </div>

            <div class="card-body p-3 d-flex flex-column">
                <h5 class="fw-bold fs-6 mb-2">{{ pickup.title }}</h5>
                <p class="small text-muted mb-3 flex-grow-1">{{ pickup.description }}</p>
                
                <div class="d-flex justify-content-between align-items-center mt-auto">
                    {# ★ここ！管理画面で入れた「価格テキスト」が自動で出ます #}
                    <span class="text-danger fw-bold fs-5">{{ pickup.price_text }}</span>
                    <span class="small fw-bold text-success">
                        一覧へ <i class="fa-solid fa-chevron-right ms-1"></i>
                    </span>
                </div>
            </div>
        </a>
    </div>
    {% empty %}
    <p class="text-center text-muted">おばちゃんが今、ええもん探してるところやで！</p>
    {% endfor %}
</div>

      <div class="container py-4 mb-5"> 
        <a href="{% url 'dicon_app:concierge_list' %}" class="btn btn-dark rounded-pill px-5 py-2">
          おばちゃん（おっちゃん）コンシェルジュのおすすめ一覧へ
        </a>
      </div>
    </div>

    <hr class="my-5 border-secondary border-opacity-10">

    <div class="row align-items-end mb-4">
        <div class="col-lg-8">
            <span class="text-warning fw-bold small ls-1">CONCIERGE</span>
            <h3 class="fw-bold m-0 text-dark">困ったときの“おせっかい”相談所</h3>
            <p class="text-muted small mt-2 mb-0">
                「予算2000円で」「魚をさばいて」「野菜の皮むいて」... 時間かかるとこは全部プロにお任せ！<br>
                チャットで伝えるだけで、あなた専用の下ごしらえ済み食材をご用意します。
            </p>
        </div>
        <div class="col-lg-4 text-lg-end d-none d-lg-block">
          <a href="{% url 'dicon_app:consult_menu' %}" class="btn btn-outline-warning text-dark rounded-pill px-5 py-2 fw-bold fs-5 shadow-sm">
            いろんな相談メニュー <i class="fa-solid fa-chevron-right ms-2"></i>
          </a>
        </div>
    </div>

    <div class="row row-cols-2 row-cols-lg-4 g-3">
    
      {% for item in consultation_items %}
    <div class="col-md-6 col-lg-4">
        <a href="{% url 'dicon_app:consult_home' %}?preset={{ item.preset_id }}" 
           class="card h-100 border-0 shadow-sm hover-scale text-decoration-none text-dark bg-white rounded-4 overflow-hidden">
            
            <div class="position-relative">
                {% if item.image %}
                    <img src="{{ item.image.url }}" 
                         class="card-img-top" 
                         alt="{{ item.title }}" 
                         style="height: 180px; object-fit: cover;">
                {% else %}
                    <div class="card-img-top bg-light d-flex align-items-center justify-content-center text-secondary" style="height: 180px;">
                        <i class="fa-solid fa-image fa-2x"></i>
                    </div>
                {% endif %}
            </div>
    
            <div class="card-body p-3">
                <h6 class="fw-bold mb-2 text-dark">【{{ item.title }}】</h6>
                <p class="text-muted mb-0 small" style="line-height: 1.4;">
                    {{ item.description|truncatechars:40 }}
                </p>
            </div>
            
            <div class="card-footer bg-transparent border-0 pt-0 pb-3">
                <span class="btn btn-light text-warning w-100 fw-bold rounded-pill btn-sm shadow-sm">
                    相談する
                </span>
            </div>
        </a>
    </div>
    {% empty %}
    {# ここが大事な「準備中」の表示です #}
    <div class="col-12 text-center py-5">
        <p class="text-muted">現在、相談メニューを準備中です。</p>
    </div>
    {% endfor %}
  
  </div>

    <div class="text-center mt-4 d-lg-none">
        <a href="{% url 'dicon_app:consult_menu' %}" class="btn btn-outline-warning text-dark rounded-pill px-4 w-100 fw-bold">
            すべての相談メニューへ
        </a>
    </div>

  </div>

</section>

<section id="locker-section" class="container mb-5" style="scroll-margin-top: 100px;">
  <div class="section-card p-0 text-white overflow-hidden rounded-4 shadow-lg" 
     style="background: linear-gradient(135deg, #2E7D32 0%, #66BB6A 100%);">
    <div class="row g-0 align-items-center">
      
      <div class="col-lg-6 p-5 position-relative z-1">
        <span class="badge bg-warning text-dark fw-bold mb-3 px-3 py-2 rounded-pill shadow-sm animate-pulse">
            <i class="fa-regular fa-clock me-1"></i>24時間受取OK
        </span>
        
        <h2 class="fw-bold display-6 mb-4" style="font-family: 'Mochiy Pop One', sans-serif;">
            お店の閉店時間は、<br>
            気にしなくて大丈夫。
        </h2>
        
        <p class="text-white mb-4 shadow-text" style="line-height: 1.5; font-weight: 500;">
          <span class="text-warning fw-bold d-block mb-2" style="font-size: 1.3rem; letter-spacing: 0.02rem;">
            「献立に迷って店内を回る時間ゼロ」
          </span>
          
          <span class="d-inline-block" style="font-size: 1rem; opacity: 0.95;">16時までの注文で、お迎え前後や残業帰りでも、</span><br class="d-none d-md-block">
          <span class="d-inline-block" style="font-size: 1rem; opacity: 0.95;">商店街の新鮮食材や惣菜を</span><br class="d-md-none">
          <strong class="border-bottom border-warning border-2 d-inline-block mt-1" style="font-size: 1.05rem;">
            24時間いつでも「あなたの冷蔵庫」
          </strong><span style="font-size: 1rem; opacity: 0.95;">から、</span><br class="d-none d-md-block">
          <span class="d-inline-block" style="font-size: 1rem; opacity: 0.95;">スマホをかざすだけでお持ち帰りいただけます。</span>
        </p>

        <div class="d-flex gap-3 mb-4">
            <div class="d-flex align-items-center bg-white bg-opacity-10 px-3 py-2 rounded-3 border border-white border-opacity-10">
                <i class="fa-solid fa-snowflake text-info fs-5 me-2"></i>
                <div class="lh-1 text-start">
                    <span class="d-block fw-bold small">冷蔵</span>
                    <span style="font-size: 0.6rem; opacity: 0.7;">新鮮キープ</span>
                </div>
            </div>
            <div class="d-flex align-items-center bg-white bg-opacity-10 px-3 py-2 rounded-3 border border-white border-opacity-10">
                <i class="fa-solid fa-mobile-screen text-warning fs-5 me-2"></i>
                <div class="lh-1 text-start">
                    <span class="d-block fw-bold small">スマホ</span>
                    <span style="font-size: 0.6rem; opacity: 0.7;">かざすだけ</span>
                </div>
            </div>
            <div class="d-flex align-items-center bg-white bg-opacity-10 px-3 py-2 rounded-3 border border-white border-opacity-10">
                <i class="fa-solid fa-user-slash text-success fs-5 me-2"></i>
                <div class="lh-1 text-start">
                    <span class="d-block fw-bold small">非対面</span>
                    <span style="font-size: 0.6rem; opacity: 0.7;">気楽に</span>
                </div>
            </div>
        </div>

        <a href="{% url 'dicon_app:locker_guide' %}" 
            class="btn btn-light text-success fw-bold px-5 py-3 rounded-pill shadow-lg animate-pulse text-decoration-none fs-5">
              <i class="fa-solid fa-circle-play me-2"></i>使い方を見る
        </a>
      </div>

      <div class="col-lg-6 position-relative overflow-hidden d-flex align-items-center justify-content-center" style="min-height: 480px;">
        
        <div class="position-absolute top-0 end-0 w-100 h-100" style="background: radial-gradient(circle at 70% 30%, rgba(255, 193, 7, 0.15) 0%, transparent 60%);"></div>

        <div class="position-absolute w-100 h-100 opacity-10" style="background-image: linear-gradient(#fff 1px, transparent 1px), linear-gradient(90deg, #fff 1px, transparent 1px); background-size: 50px 50px;"></div>

        <div class="position-relative shadow-lg" style="width: 260px; height: 500px; background: #000; border-radius: 40px; border: 8px solid #1a1a1a; box-shadow: 0 20px 50px -10px rgba(0,0,0,0.6);">
          
          <div class="position-absolute top-0 start-50 translate-middle-x bg-dark rounded-bottom-4 z-3" style="width: 40%; height: 25px;"></div>

          <div class="w-100 h-100 bg-white overflow-hidden position-relative d-flex flex-column" style="border-radius: 32px;">
            
            <div class="bg-white border-bottom pt-4 pb-2 px-3 d-flex align-items-center justify-content-between">
                <i class="fa-solid fa-bars text-secondary"></i>
                <span class="fw-bold small">受取キー</span>
                <i class="fa-regular fa-bell text-secondary"></i>
            </div>
            
            <div class="flex-grow-1 d-flex flex-column align-items-center justify-content-center px-4 bg-light">
                
                <div class="bg-white p-4 rounded-4 shadow-sm w-100 text-center position-relative mb-3">
                    <p class="small text-muted fw-bold mb-2">読み取りリーダーにかざす</p>
                    
                    <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=DiconAppLockerUnlockKey8823&color=111111" 
                         alt="QR Code" class="img-fluid mb-2" style="width: 140px; opacity: 0.9;">
                    
                    <div class="position-absolute start-0 w-100 bg-danger opacity-25 shadow-sm" style="height: 4px; top: 20%; animation: scan 2.5s infinite ease-in-out;"></div>
                    
                    <div class="mt-2 text-dark fw-bold ls-2" style="font-family: monospace;">KEY: 8823</div>
                </div>

                <div class="d-flex align-items-center justify-content-center gap-2 w-100 mb-2">
                     <span class="badge bg-success bg-opacity-10 text-success border border-success px-3 py-2 rounded-pill w-100">
                        <i class="fa-solid fa-check-circle me-1"></i>受取準備完了
                     </span>
                </div>
                
                <div class="bg-dark text-white rounded-3 p-2 w-100 text-center small">
                    <i class="fa-solid fa-box-open me-2 text-warning"></i>BOX番号: <span class="fw-bold fs-6">B-05</span>
                </div>

            </div>

            <div class="p-3 bg-white border-top">
                <button class="btn btn-danger w-100 rounded-pill fw-bold py-2 shadow-sm hover-scale">
                    <i class="fa-solid fa-lock-open me-2"></i>解錠する
                </button>
            </div>

          </div>
        </div>

        <div class="position-absolute bottom-0 end-0 p-5 text-white" style="margin-right: -20px; margin-bottom: 20px; animation: floatHand 3s infinite ease-in-out;">
            <i class="fa-solid fa-hand-pointer fa-4x text-warning" style="transform: rotate(-30deg); filter: drop-shadow(0 5px 15px rgba(0,0,0,0.5));"></i>
        </div>

      </div>

    </div>
  </div>
</section>

<style>
@keyframes scan {
    0% { top: 20%; opacity: 0.8; }
    50% { top: 70%; opacity: 0.8; }
    100% { top: 20%; opacity: 0.8; }
}
@keyframes floatHand {
    0%, 100% { transform: translateY(0) rotate(-30deg); }
    50% { transform: translateY(-15px) rotate(-30deg); }
}
</style>

{% if upcoming_events or regular_events %}
<section id="event" class="container mb-5">
  
  <div class="section-card p-4 p-lg-5 bg-white shadow-sm rounded-4">

    <div class="text-center mb-5">
      <span class="badge bg-warning text-dark px-3 py-2 rounded-pill mb-2 shadow-sm">FUN! FUN!</span>
      <h2 class="fw-bold display-6 text-dark" style="font-family: 'Mochiy Pop One', sans-serif;">
        商店街って最強の遊び場！<br>マルシェ、夜市、ヒーロー大暴れのアーケード<br>そこはもう異世界（テーマパーク）！
      </h2>
      <p class="text-muted mt-3">
        マルシェ、夜市、ヒーローショー。<br>
        いつもの通りが「テーマパーク」に変わる日。
      </p>
    </div>

    <div class="row g-4">
      {% for event in upcoming_events %}
        <div class="col-12 col-md-6">
          <a href="{% url 'dicon_app:event_detail' slug=event.slug %}" class="text-decoration-none text-dark">
            <div class="card h-100 border hover-scale rounded-4 overflow-hidden bg-white">
              
              <div class="ratio ratio-16x9">
                {% if event.image %}
                  <img src="{{ event.image.url }}" class="w-100 h-100 object-fit-cover" alt="{{ event.title }}">
                {% else %}
                  <div class="w-100 h-100 bg-secondary d-flex align-items-center justify-content-center text-white">
                    <i class="fa-regular fa-calendar fa-3x"></i>
                  </div>
                {% endif %}
              </div> <div class="card-body p-4 bg-white">
                <small class="text-danger fw-bold d-block mb-2">
                  <i class="fa-regular fa-clock me-1"></i>
                  {% if event.start_date %}
                    {{ event.start_date|date:"n月j日(D)" }}
                  {% else %}
                    近日開催
                  {% endif %}
                </small>
                <h4 class="card-title fw-bold mb-2">{{ event.title }}</h4>
                <p class="card-text text-muted small mb-0">
                  {{ event.description|truncatechars:50 }}
                </p>
              </div>
            </div>
          </a>
        </div>
      {% empty %}
        <div class="col-12 text-center py-5">
          <p class="text-muted">現在予定されているイベントはありません。</p>
        </div>
      {% endfor %}
    </div>
    
    <div class="text-center mt-5">
      <a href="{% url 'dicon_app:event_list' %}" class="btn btn-outline-dark rounded-pill px-4">
        イベント一覧を見る
      </a>
    </div>

  </div> 
</section>
{% endif %}

<section id="partner" class="container mb-5">
  <div class="section-card p-4 p-lg-5 bg-white border-0">
      
      <div class="text-center mb-5">
          <span class="badge bg-primary mb-2 px-3 py-2 rounded-pill fw-bold shadow-sm">
              <i class="fa-solid fa-handshake-angle me-1"></i> 認定パートナー制度
          </span>
          <h2 class="fw-bold display-6 mb-3 text-dark">
              商店街はもっと頼れる場所へ<br>ご相談待っています！
          </h2>
          <p class="text-muted lead" style="font-size: 1rem;">
              厳しい審査を通過した地元のプロが、あなたの暮らしを誠実にサポートします。
          </p>
      </div>

      <div class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-4">
    {% for partner in partners %}
    <div class="col">
        <div class="card h-100 border shadow-sm rounded-4 overflow-hidden hover-scale bg-white" style="border-top: 4px solid #0d6efd !important; border-color: rgba(13, 110, 253, 0.1);">
            <div class="card-body p-4 text-center"> 
                <div class="mb-3 position-relative d-inline-block">
                    {% if partner.image %}
                    <img src="{{ partner.image.url }}" class="rounded-circle border border-2 border-primary border-opacity-25 p-1" style="width: 90px; height: 90px; object-fit: cover;">
                    {% else %}
                    <div class="bg-light rounded-circle d-inline-flex align-items-center justify-content-center shadow-sm" style="width: 90px; height: 90px;">
                        <i class="fa-solid fa-user text-primary opacity-50 fa-2x"></i>
                    </div>
                    {% endif %}
                    <span class="position-absolute bottom-0 end-0 bg-primary text-white rounded-circle d-flex align-items-center justify-content-center shadow-sm" style="width: 24px; height: 24px; border: 2px solid white;">
                        <i class="fa-solid fa-check" style="font-size: 12px;"></i>
                    </span>
                </div>

                <h5 class="fw-bold text-dark mb-1 fs-6">{{ partner.name }}</h5>
                <div class="mb-2">
                    <span class="badge bg-light text-primary border border-primary border-opacity-25 small" style="font-size: 0.7rem;">認定事業者</span>
                </div>
                <p class="small text-muted mb-3" style="line-height: 1.5; height: 4.5em; overflow: hidden;">
                    {{ partner.description|truncatechars:60 }}
                </p>

                <div class="mt-auto">
                    <a href="{% url 'dicon_app:partner_list' %}" class="btn btn-primary btn-sm rounded-pill px-4 fw-bold shadow-sm w-100">
                        相談する <i class="fa-solid fa-chevron-right ms-1"></i>
                    </a>
                </div>

            </div>
        </div>
    </div>
    {% endfor %}
</div>

    <div class="text-center mt-5">
        <a href="{% url 'dicon_app:partner_list' %}" class="btn btn-primary rounded-pill px-5 py-3 fw-bold hover-scale shadow" style="background: linear-gradient(45deg, #0d6efd, #0a58ca);">
            認定事業者一覧をすべて見る <i class="fa-solid fa-circle-chevron-right ms-2"></i>
        </a>
        <p class="text-muted small mt-3"><i class="fa-solid fa-shield-halved me-1"></i> 私たちは地域に根ざした誠実な対応をお約束します</p>
    </div>

  </div>
</section>

<!-- <section id="vacant-store" class="container mb-5">
  <div class="section-card p-4 p-lg-5">
      
      <div class="text-center mb-5">
          <span class="badge bg-warning text-dark mb-2 px-3 py-2 rounded-pill fw-bold">VACANT STORE</span>
          <h2 class="fw-bold display-6 mb-3 text-dark">
              この街で、あなたの夢を。<br>空き店舗、こうなってます。
          </h2>
      </div>

      <div class="card border-0 rounded-4 overflow-hidden shadow-lg text-white position-relative" 
           style="background: url('https://images.unsplash.com/photo-1556740758-90de374c12ad?auto=format&fit=crop&w=1200&q=80') center/cover; min-height: 450px;">
          
          <div class="position-absolute top-0 start-0 w-100 h-100 bg-dark opacity-75"></div>
          
          <div class="card-body p-4 p-lg-5 position-relative z-1 d-flex flex-column text-center justify-content-center h-100">
              <p class="text-white fw-bold mb-4 lead" style="line-height: 2; text-shadow: 0 2px 4px rgba(0,0,0,0.5);">
                  古い金物屋が「古着バー」に。<br>
                  時計屋さんが「レトロ喫茶」に。<br>
                  新しい「おせっかい」が、この街を面白くしています。
              </p>

              <div class="row g-3 mb-5 justify-content-center">
                  <div class="col-4 col-md-2">
                      <img src="https://images.unsplash.com/photo-1554118811-1e0d58224f24?auto=format&fit=crop&w=200&q=80" class="rounded-4 w-100 border border-3 border-white shadow" alt="Cafe" style="height: 100px; object-fit: cover;">
                  </div>
                  <div class="col-4 col-md-2">
                      <img src="https://images.unsplash.com/photo-1524316885361-b1b6c0e5a6b0?auto=format&fit=crop&w=200&q=80" class="rounded-4 w-100 border border-3 border-white shadow" alt="Book" style="height: 100px; object-fit: cover;">
                  </div>
                  <div class="col-4 col-md-2">
                      <img src="https://images.unsplash.com/photo-1595856488331-507949392289?auto=format&fit=crop&w=200&q=80" class="rounded-4 w-100 border border-3 border-white shadow" alt="Shop" style="height: 100px; object-fit: cover;">
                  </div>
              </div>

              <div class="text-center">
                  <a href="{% url 'dicon_app:vacant_store' %}" class="btn btn-warning text-dark rounded-pill px-5 py-3 fw-bold shadow-lg hover-scale">
                      空き物件情報を見る <i class="fa-solid fa-chevron-right ms-2"></i>
                  </a>
              </div>
          </div>
      </div>

  </div>
</section> -->

<section id="challenge" class="container mb-5">
  <div class="section-card p-4 p-lg-5 text-center" style="background: linear-gradient(135deg, #fff5f5 0%, #ffffff 100%); border-radius: 2rem; border: 2px dashed #ff4d4d;">
      
      <div class="mb-4">
          <span class="badge bg-danger mb-2 px-3 py-2 rounded-pill fw-bold animate-bounce">
              <i class="fa-solid fa-rocket me-1"></i> U-25 チャレンジ募集中！
          </span>
          <h2 class="fw-bold display-5 mb-3 text-dark">
              この街で、あなたの「やりたい」を形に。<br>
              <span class="text-danger">空き店舗、貸し切り放題スタート！</span>
          </h2>
      </div>

      <div class="row g-4 mb-5 text-start">
          <div class="col-md-4">
              <div class="p-4 bg-white rounded-4 shadow-sm h-100 border-bottom border-4 border-danger">
                  <div class="text-danger mb-3"><i class="fa-solid fa-graduation-cap fa-2x"></i></div>
                  <h4 class="fw-bold">学生の「単位」を応援！</h4>
                  <p class="small text-muted">小・中・高・大学生の皆さん！ここでの活動が学校の「単位」や「ボランティア実績」になるよう、商店街が全力で公式証明書を発行します。履歴書にも堂々と書ける実績をここで作ろう！</p>
              </div>
          </div>
          <div class="col-md-4">
              <div class="p-4 bg-white rounded-4 shadow-sm h-100 border-bottom border-4 border-warning">
                  <div class="text-warning mb-3"><i class="fa-solid fa-fire-flame-curved fa-2x"></i></div>
                  <h4 class="fw-bold">「赤い人」が全力伴走！</h4>
                  <p class="small text-muted">失敗しても大丈夫。商店街の「赤い情熱（おせっかい）」を持ったプロたちが、仕入れから接客までマンツーマンで指導。君の背中をドーンと押して、盛り上げるで！</p>
              </div>
          </div>
          <div class="col-md-4">
              <div class="p-4 bg-white rounded-4 shadow-sm h-100 border-bottom border-4 border-primary">
                  <div class="text-primary mb-3"><i class="fa-solid fa-child-reaching fa-2x"></i></div>
                  <h4 class="fw-bold">ちびっこ起業家求む！</h4>
                  <p class="small text-muted">小学生の一日店長や、自分たちで作ったものを売る「起業マルシェ」も開催。お金の仕組みから「ありがとう」の重みまで、商店街が教室に変わる日！</p>
              </div>
          </div>
      </div>

      <div class="bg-dark text-white p-4 rounded-4 mb-4">
          <p class="mb-0 lead fw-bold">
              「こんなこと、できるかな？」その一言から始まります。<br>
              <span class="text-warning">スポット（1日）利用OK！　利用料：学生は「やる気」で応相談！</span>
          </p>
      </div>

      <a href="{% url 'dicon_app:consult_home' %}" class="btn btn-danger btn-lg rounded-pill px-5 py-3 fw-bold shadow-lg hover-scale">
          おせっかいおじさんに企画をぶつける！ <i class="fa-solid fa-paper-plane ms-2"></i>
      </a>
  </div>
</section>

{% endblock %}